---
title: "v0.9: DevTools, Resource.extend, and Legacy Cleanup"
authors: [ntucker]
tags: [releases, rest, resource, endpoint]
description: Data Client 0.9 brings improved DevTools experience, Resource.extend() for customization, new controller methods, and removes legacy APIs for a cleaner, faster library.
---

import Link from '@docusaurus/Link';

This release focuses on developer experience with a [devtools button](/blog/2024/01/15/v0.9-release-announcement#devtools-button) that appears in development
mode, better [DevTools history](/blog/2024/01/15/v0.9-release-announcement#devtools-improvements), and new controller methods like
[controller.expireAll()](/blog/2024/01/15/v0.9-release-announcement#controllerexpireall) and [controller.fetchIfStale()](/blog/2024/01/15/v0.9-release-announcement#controllerfetchifstale).

[Resource.extend()](/rest/api/resource#extend) provides three powerful ways to customize resources - adding new endpoints,
overriding existing ones, or deriving from base endpoints.

```ts
const UserResource = createResource({
  path: '/users/:id',
  schema: User,
}).extend('current', {
  path: '/users/current',
});
```

<center>

<Link className="button button--secondary" to="/blog/2024/01/15/v0.9-release-announcement#migration-guide">Migration guide</Link>

</center>

**Breaking Changes:**

- [Remove all /next exports](/blog/2024/01/15/v0.9-release-announcement#remove-next-exports)
- [makeCacheProvider removed](/blog/2024/01/15/v0.9-release-announcement#makecacheprovider-removed)
- [DELETE -> INVALIDATE action type](/blog/2024/01/15/v0.9-release-announcement#delete-invalidate)
- [Legacy schema support dropped](/blog/2024/01/15/v0.9-release-announcement#legacy-schema-support-dropped)
- [Schema Serializers must support function calls](/blog/2024/01/15/v0.9-release-announcement#schema-serializers)
- [Action types prefixed with 'rdc'](/blog/2024/01/15/v0.9-release-announcement#action-types-prefix)

<!--truncate-->

import DiffEditor from '@site/src/components/DiffEditor';
import PkgTabs from '@site/src/components/PkgTabs';

## Resource.extend() <small>(since 0.5)</small>

[Resource.extend()](/rest/api/resource#extend) provides three powerful ways to customize resources.
[51b4b0d](https://github.com/reactive/data-client/commit/51b4b0d188)

### Add new endpoints

```ts
const UserResource = createResource({
  path: '/users/:id',
  schema: User,
}).extend('current', {
  path: '/users/current',
});
```

### Override existing endpoints

```ts
const CachedArticleResource = ArticleResource.extend({
  getList: {
    dataExpiryLength: 10 * 60 * 1000, // 10 minutes
  },
});
```

### Derive from base endpoints

```ts
const IssueResource = createResource({
  path: '/issues/:id',
  schema: Issue,
}).extend(Base => ({
  byRepo: Base.getList.extend({
    path: '/repos/:owner/:repo/issues',
  }),
}));
```

## Controller Methods

### controller.expireAll() <small>(since 0.3)</small>

Sets all matching responses to *stale*, triggering background refetch while showing existing data.
[#2802](https://github.com/reactive/data-client/pull/2802)

```ts
// Mark all article lists as stale - they'll refetch when rendered
controller.expireAll(ArticleResource.getList);
```

This differs from `invalidateAll()` which removes the data entirely. `expireAll()` keeps showing
the cached data while fetching fresh data in the background.

### controller.fetchIfStale() <small>(since 0.4)</small>

Fetches only if data is considered stale; otherwise returns the cached data.
[#2804](https://github.com/reactive/data-client/pull/2804)

```ts
// Perfect for prefetching - won't overfetch fresh data
const resolveData = async (controller, { owner, repo }) => {
  await controller.fetchIfStale(IssueResource.getList, { owner, repo });
};
```

## DevTools Improvements

### DevTools Button {#devtools-button}

A floating button now appears in development mode to quickly open the Redux DevTools extension.
[#2803](https://github.com/reactive/data-client/pull/2803)

Configure or disable it via the `devButton` prop:

```tsx
// Disable the button
<CacheProvider devButton={null}>
  <App />
</CacheProvider>
```

```tsx
// Position it differently
<CacheProvider devButton="top-right">
  <App />
</CacheProvider>
```

### Persistent History

DevTools no longer forgets history if not open on page load.
[2d2e941](https://github.com/reactive/data-client/commit/2d2e94126e)

### Better State Tracking

Since React 18 batches updates, the real state can sometimes update from multiple actions.
When devtools are open, a shadow state accurately reflects changes from each action for easier debugging.
[c9ca31f](https://github.com/reactive/data-client/commit/c9ca31f3f4)

### Endpoint Properties Visible

Endpoint properties are now fully visible in the devtool inspector.
[a7da00e](https://github.com/reactive/data-client/commit/a7da00e82d)

## Collection Enhancements

### FormData argument filtering <small>(since 0.4)</small>

[Collections](/rest/api/Collection) can now filter based on FormData arguments. [f95dbc6](https://github.com/reactive/data-client/commit/f95dbc64d1)

```ts
ctrl.fetch(getPosts.push, { group: 'react' }, new FormData(e.currentTarget));
```

If the FormData contains an `author` field, the newly created item will be properly added to
collections filtered by that author.

### paginationField <small>(since 0.7)</small>

Use [paginationField](/rest/api/RestEndpoint#paginationfield) for easy pagination support.
[c8c557](https://github.com/reactive/data-client/commit/c8c5575e5a)

```ts
const TodoResource = createResource({
  path: '/todos/:id',
  schema: Todo,
  paginationField: 'page',
});

// Fetches page 2 and appends to the collection
ctrl.fetch(TodoResource.getList.getPage, { page: '2' });
```

## Other Improvements

- Add `className` to ErrorBoundary and `errorClassName` to [AsyncBoundary](/docs/api/AsyncBoundary) [#2785](https://github.com/reactive/data-client/pull/2785)
- New `getDefaultManagers()` export for explicit manager control [#2791](https://github.com/reactive/data-client/pull/2791)
- Replace BackupBoundary with UniversalSuspense + BackupLoading [#2803](https://github.com/reactive/data-client/pull/2803)
- Entity.process() receives endpoint `args` as fourth parameter *(since 0.7)* [a8936f5](https://github.com/reactive/data-client/commit/a8936f5e6d)
- `nonFilterArgumentKeys` for Collection to exclude sort/order params from filtering *(since 0.7)* [318df89](https://github.com/reactive/data-client/commit/318df89bf7)

## Migration Guide

This upgrade requires updating all package versions simultaneously.

<PkgTabs pkgs="@data-client/react@^0.9.0 @data-client/rest@^0.9.0 @data-client/test@^0.9.0 @data-client/img@^0.9.0 @data-client/hooks@^0.9.0" upgrade />

### Remove /next exports {#remove-next-exports}

All `/next` subpath exports have been removed. Features previously in `/next` are now
the standard exports. [f65cf83](https://github.com/reactive/data-client/commit/f65cf832f0)

<DiffEditor>

```ts title="Before"
import { useController } from '@data-client/react/next';
```

```ts title="After"
import { useController } from '@data-client/react';
```

</DiffEditor>

### makeCacheProvider removed {#makecacheprovider-removed}

Use the provider component directly with makeRenderDataClient.
[#2787](https://github.com/reactive/data-client/pull/2787)

<DiffEditor>

```tsx title="Before"
import { makeCacheProvider } from '@data-client/react';
const renderDataClient = makeRenderDataClient(makeCacheProvider);
```

```tsx title="After"
import { CacheProvider } from '@data-client/react';
const renderDataClient = makeRenderDataClient(CacheProvider);
```

</DiffEditor>

### DELETE -> INVALIDATE action type {#delete-invalidate}

The DELETE action type has been renamed to INVALIDATE for clarity.
[#2784](https://github.com/reactive/data-client/pull/2784)

<DiffEditor>

```ts title="Before"
import { DELETE_TYPE } from '@data-client/react';
```

```ts title="After"
import { INVALIDATE_TYPE } from '@data-client/react';
```

</DiffEditor>

### Legacy schema support dropped {#legacy-schema-support-dropped}

All support for legacy schemas has been removed. Ensure you're using the current
Entity class. [#2784](https://github.com/reactive/data-client/pull/2784)

- `entity.expiresAt` removed
- All Entity overrides for backwards compatibility removed

### Schema Serializers must support function calls {#schema-serializers}

[Schema Serializers](/rest/guides/network-transform#deserializing-fields) must now support
function calls. `Date` no longer works directly. [#2795](https://github.com/reactive/data-client/pull/2795)

<DiffEditor>

```ts title="Before"
class MyEntity extends Entity {
  createdAt = new Date();

  static schema = {
    // highlight-next-line
    createdAt: Date,
  };
}
```

```ts title="After"
class MyEntity extends Entity {
  createdAt = new Date();

  static schema = {
    // highlight-next-line
    createdAt: (iso: string) => new Date(iso),
  };
}
```

</DiffEditor>

Alternatively, use Temporal:

```ts
import { Temporal } from '@js-temporal/polyfill';

class MyEntity extends Entity {
  createdAt = Temporal.Instant.fromEpochSeconds(0);

  static schema = {
    createdAt: Temporal.Instant.from,
  };
}
```

### Action types prefixed with 'rdc' {#action-types-prefix}

All action types are now prefixed with 'rdc' for better namespacing.
[#2781](https://github.com/reactive/data-client/pull/2781)

### receive -> set action names

All 'receive' action names have been renamed to 'set'.
[#2782](https://github.com/reactive/data-client/pull/2782)

<DiffEditor>

```ts title="Before"
import { ReceiveAction, RECEIVE_TYPE } from '@data-client/react';
controller.receive(endpoint, args, response);
```

```ts title="After"
import { SetAction, SET_TYPE } from '@data-client/react';
controller.set(endpoint, args, response);
```

</DiffEditor>

### Middleware API simplified

Middleware no longer receives `controller` as a destructured property - it receives
controller directly. [#2786](https://github.com/reactive/data-client/pull/2786)

<DiffEditor>

```ts title="Before"
class LoggingManager implements Manager {
  // highlight-next-line
  getMiddleware = (): Middleware => ({ controller }) => next => async action => {
    console.log('before', action, controller.getState());
    await next(action);
    console.log('after', action, controller.getState());
  };

  cleanup() {}
}
```

```ts title="After"
class LoggingManager implements Manager {
  // highlight-next-line
  getMiddleware = (): Middleware => controller => next => async action => {
    console.log('before', action, controller.getState());
    await next(action);
    console.log('after', action, controller.getState());
  };

  cleanup() {}
}
```

</DiffEditor>

### getDefaultManagers()

CacheProvider elements no longer share default managers. Use `getDefaultManagers()` for explicit control.
[#2791](https://github.com/reactive/data-client/pull/2791)

```ts
import { getDefaultManagers, CacheProvider } from '@data-client/react';

const managers = getDefaultManagers();

<CacheProvider managers={managers}>
  <App />
</CacheProvider>
```

### Upgrade support

As usual, if you have any troubles or questions, feel free to join our [![Chat](https://img.shields.io/discord/768254430381735967.svg?style=flat-square&colorB=758ED3)](https://discord.gg/wXGV27xm6t) or [file a bug](https://github.com/reactive/data-client/issues/new/choose)
