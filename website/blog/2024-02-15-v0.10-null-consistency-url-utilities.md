---
title: "v0.10: Consistent Null Handling, URL Utilities"
authors: [ntucker]
tags: [releases, rest, endpoint, schema]
description: Data Client 0.10 brings consistent null handling across all schemas, new URL construction utilities for RestEndpoint, and fixes memory leaks in DevTools.
---

import Link from '@docusaurus/Link';

This release focuses on consistency and extensibility. [Null handling](/blog/2024/02/15/v0.10-null-consistency-url-utilities#null-consistency) is now uniform across all schema types,
making data transformations more predictable. New [URL utilities](/blog/2024/02/15/v0.10-null-consistency-url-utilities#url-utilities) enable custom URL construction and search parameter encoding.

```ts
class MyEndpoint<O extends RestGenerics = any> extends RestEndpoint<O> {
  searchToString(searchParams) {
    // Use qs library for complex nested object encoding
    return qs.stringify(searchParams);
  }
}
```

<center>

<Link className="button button--secondary" to="/blog/2024/02/15/v0.10-null-consistency-url-utilities#migration-guide">Migration guide</Link>

</center>

**Breaking Changes:**

- [Null values retained in Array/Object schemas](/blog/2024/02/15/v0.10-null-consistency-url-utilities#null-consistency)

**Other Improvements:**

- [RestEndpoint.searchToString()](/blog/2024/02/15/v0.10-null-consistency-url-utilities#searchtostring) for custom search param encoding
- [getUrlBase, getUrlTokens exports](/blog/2024/02/15/v0.10-null-consistency-url-utilities#url-utilities) for custom URL construction
- [DevToolsManager memory leak fix](/blog/2024/02/15/v0.10-null-consistency-url-utilities#devtools-fix)

<!--truncate-->

import DiffEditor from '@site/src/components/DiffEditor';
import PkgTabs from '@site/src/components/PkgTabs';

## Consistent null handling {#null-consistency}

`null` values are now consistently retained across all schema types. Previously, `[]` shorthand and [schema.Array](/rest/api/Array)
behaved differently when encountering `null` values. [#2912](https://github.com/reactive/data-client/pull/2912)

- `[]` and [schema.Array](/rest/api/Array) now behave identically
- `null` values are retained everywhere (they were already retained in [nested Entities](/rest/guides/relational-data#nesting))
- `undefined` values are still filtered out

This change ensures more predictable behavior when working with APIs that explicitly return `null` to indicate
absence of data versus `undefined` for missing fields.

## URL Utilities {#url-utilities}

### RestEndpoint.searchToString() {#searchtostring}

[RestEndpoint.searchToString()](/rest/api/RestEndpoint#searchToString) enables custom encoding of search parameters.
This is particularly useful for APIs that expect complex nested objects in query strings.
[#2919](https://github.com/reactive/data-client/pull/2919)

For example, to encode complex objects using the [qs](https://github.com/ljharb/qs) library:

```typescript
import { RestEndpoint, RestGenerics } from '@data-client/rest';
import qs from 'qs';

class MyEndpoint<O extends RestGenerics = any> extends RestEndpoint<O> {
  searchToString(searchParams) {
    return qs.stringify(searchParams);
  }
}
```

### getUrlBase, getUrlTokens {#geturlbase}

New exports `getUrlBase` and `getUrlTokens` provide the building blocks for custom
[RestEndpoint.url()](/rest/api/RestEndpoint#url) implementations.
[#2919](https://github.com/reactive/data-client/pull/2919)

```ts
import { getUrlBase, getUrlTokens } from '@data-client/rest';

// Parse path tokens for custom URL logic
const tokens = getUrlTokens('/users/:id/posts/:postId');
// => ['id', 'postId']

// Get base URL without path parameters
const base = getUrlBase('/users/:id');
// => '/users/'
```

## DevToolsManager memory fix {#devtools-fix}

The DevToolsManager action buffer is now limited to 100 entries, preventing memory leaks in long-running
applications or those with frequent updates. [`4e6a39e`](https://github.com/reactive/data-client/commit/4e6a39ea2bfdb1390051f12781e899488609e1a8)

## Migration Guide

This upgrade requires updating all package versions simultaneously.

<PkgTabs pkgs="@data-client/react@^0.10.0 @data-client/rest@^0.10.0 @data-client/test@^0.10.0 @data-client/img@^0.10.0" upgrade />

### Null values in arrays {#null-arrays}

If your code relied on `null` values being filtered out of arrays, you'll need to handle this explicitly:

<DiffEditor>

```ts title="Before"
import { Entity, schema, RestEndpoint } from '@data-client/rest';

class User extends Entity {
  id = '';
  name = '';
  pk() { return this.id; }
}

const getUsers = new RestEndpoint({
  path: '/users',
  schema: new schema.Array(User),
});

// API response: [{ id: '1' }, null, { id: '2' }]
const usersWithoutNull = useSuspense(getUsers);
```

```ts title="After"
import { Entity, schema, RestEndpoint } from '@data-client/rest';

class User extends Entity {
  id = '';
  name = '';
  pk() { return this.id; }
}

const getUsers = new RestEndpoint({
  path: '/users',
  schema: new schema.Array(User),
});

// API response: [{ id: '1' }, null, { id: '2' }]
const usersWithoutNull = useSuspense(getUsers).filter(Boolean);
```

</DiffEditor>

This change aligns with how [nested Entities](/rest/guides/relational-data#nesting) already handled `null` values,
making the behavior consistent across all schema types.

### Upgrade support

As usual, if you have any troubles or questions, feel free to join our [![Chat](https://img.shields.io/discord/768254430381735967.svg?style=flat-square&colorB=758ED3)](https://discord.gg/wXGV27xm6t) or [file a bug](https://github.com/reactive/data-client/issues/new/choose)

